/**
 * 生成预览用单个 demo 的 js 文件
 * @type {module:path}
 */
const path = require('path');
const generateEntry = require('./generateEntry');
const getDirs = require('../getDirs');

function generateDemoEntry(demos = [], rootDir) {
  // generate demo entry
  const entries = {};
  const { TMP_FILE_DIR } = getDirs(rootDir);

  demos.forEach((demo) => {
    const { componentName, filename } = demo;
    const entryPath = path.join(TMP_FILE_DIR, `demo-${componentName}-${filename}.js`);
    entries[`${componentName}$$${filename}`] = entryPath;

    generateEntry({
      template: 'raxDemo.hbs',
      outputPath: entryPath,
      params: {
        demos: [demo],
      },
    });
  });

  return { entries };
}

module.exports = generateDemoEntry;
