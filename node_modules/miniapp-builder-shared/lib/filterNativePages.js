"use strict";

var _require = require('path'),
    dirname = _require.dirname,
    join = _require.join;

var _require2 = require('./pathHelper'),
    getDepPath = _require2.getDepPath,
    isNativePage = _require2.isNativePage;
/**
 * Filter native page
 * @param {Array} routes - user routes
 * @param {Array} needCopyList - need copy miniapp native pages
 * @param {object} options - function options
 * @param {string} options.rootDir - project root directory
 * @param {string} options.target - user platform
 * @returns {Array}
 */


module.exports = function (routes, needCopyList, _ref) {
  var rootDir = _ref.rootDir,
      target = _ref.target;
  return routes.filter(function (_ref2) {
    var source = _ref2.source;
    var pageEntry = getDepPath(rootDir, source);

    if (isNativePage(pageEntry, target)) {
      needCopyList.push({
        from: dirname(join('src', source)),
        to: dirname(source)
      });
      return false;
    }

    return true;
  });
};